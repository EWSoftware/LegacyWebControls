//=============================================================================
// File    : PatternTextBox.js
// Author  : Eric Woodruff  (Eric@EWoodruff.us)
// Updated : Fri 12/12/03
function PTB_Keys(a,b,c){if(b==13)switch(c){case"Phone":PTB_FormatPhone(a);break;case"Zip":PTB_FormatZip(a);break;case"SSN":PTB_FormatSSN(a);break;default:break;}return true;}function PTB_FormatPhone(a){var d,e,f="",g=true;e=a.value;for(d=6;d<e.length;d++)if(e.charAt(d)==" "||e.charAt(d)=="x"||e.charAt(d)=="X")break;if(d<e.length){f=e.substr(d);if(f.substr(0,1)=="X")f="x"+f.substr(1);e=e.substr(0,d);}e=e.replace(/^\s*/g,"");if(e.substr(0,1)!="("&&e.substr(3,1)=="-")g=false;e=e.replace(/[^0-9]/g,"");if(e.length==7||e.length==10){if(e.length==7)e=e.substr(0,3)+"-"+e.substr(3);else{if(g==true)e="("+e.substr(0,3)+") "+e.substr(3,3)+"-"+e.substr(6);else e=e.substr(0,3)+"-"+e.substr(3,3)+"-"+e.substr(6);}e=e+f;if(e!=a.value){a.value=e;if(a.onchange!=null)a.onchange();}}}function PTB_FormatZip(a){var h,i;h=a.value.replace(/[^0-9\-]/g,"");d=h.indexOf("-");if(d==-1&&h.length>5&&h.length<10){i=h.substr(5);while(i.length<4)i="0"+i;a.value=h.substr(0,5)+"-"+i;if(a.onchange!=null)a.onchange();}}function PTB_FormatSSN(a){var j;j=a.value.replace(/[^0-9]/g,"");if(j.length==9)j=j.substr(0,3)+"-"+j.substr(3,2)+"-"+j.substr(5);if(j!=a.value){a.value=j;if(a.onchange!=null)a.onchange();}}function PTB_FormatTime(a){var k,l,m,n;k=a.value.toLowerCase().replace(/[^0-9apm\\:]/g,"");l=k.substr(k.length-2);if(l=="am"||l=="pm")k=k.substr(0,k.length-2);else if(l.charAt(1)=="a"||l.charAt(1)=="p"){l=l.charAt(1)+"m";k=k.substr(0,k.length-1);}else l="";m=k.split(":");if(m.length==1){switch(k.length){case 1:k="0"+k;case 2:k+=":00";break;case 3:k="0"+k.charAt(0)+":"+k.substr(1);break;case 4:k=k.substr(0,2)+":"+k.substr(2);break;default:k=a.value;l="";break;}}else{for(n=0;n<2;n++)if(m[n].length<2)m[n]="0"+m[n];k=m[0]+":"+m[1];}k+=l;if(k!=a.value){a.value=k;if(a.onchange!=null)a.onchange();}}function PTB_TimeKeys(a,b){var o,p,l,q,k;if(b==13){PTB_FormatTime(a);return true;}if(b!=33&&b!=34&&b!=38&&b!=40&&b!=78)return true;PTB_FormatTime(a);q=new Date();k=a.value;if(k!=""){o=parseInt(k,10);p=parseInt(k.substr(3),10);if(isNaN(o)||isNaN(p))return;l=k.substr(k.length-2);if(l!="am"&&l!="pm")if(l.charAt(1)=="a"||l.charAt(1)=="p")l=l.charAt(1)+"m";else l="";if(l=="pm"&&o<12)o+=12;else if(l=="am"&&o==12)o-=12;}else{o=q.getHours();p=q.getMinutes();if(o<12)l="am";else l="pm";}switch(b){case 33:q.setMinutes(p);q.setHours(o+1);break;case 34:q.setMinutes(p);q.setHours(o-1);break;case 38:q.setHours(o);q.setMinutes(p+1);break;case 40:q.setHours(o);q.setMinutes(p-1);break;default:break;}o=q.getHours();p=q.getMinutes();if(l!="")if(o<12){if(o==0)o=12;l="am";}else{if(o>12)o-=12;l="pm";}if(o<10)k="0"+o.toString()+":";else k=o.toString()+":";if(p<10)k=k+"0"+p.toString()+l;else k=k+p.toString()+l;a.value=k;a.select();if(a.onchange!=null)a.onchange();return false;}