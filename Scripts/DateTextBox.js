//=============================================================================
// File    : DateTextBox.js
// Author  : Eric Woodruff  (Eric@EWoodruff.us)
// Updated : 01/04/2008
function DTB_FormatDate(a){var d,e,f,h,i=new Date();d=a.value.toLowerCase().replace(/[^0-9/]/g,"");e=d.split("/");if(e.length==1){switch(d.length){case 1:d="0"+d+"/01/"+i.getFullYear();break;case 2:d+="/01/"+i.getFullYear();break;case 3:d="0"+d.substr(0,1)+"/"+d.substr(1,2)+"/"+i.getFullYear();break;case 4:d=d.substr(0,2)+"/"+d.substr(2)+"/"+i.getFullYear();break;case 6:h=parseInt(d.substr(4),10);if(h<1000)if(h<30||h>99)h+=2000;else h+=1900;d=d.substr(0,2)+"/"+d.substr(2,2)+"/"+h;break;case 8:d=d.substr(0,2)+"/"+d.substr(2,2)+"/"+d.substr(4);break;default:d=a.value;break;}}else{if(e[0].length<2)e[0]="0"+e[0];if(e.length==2){if(e[1].length>2){h=parseInt(e[1],10);e[1]="01";}else{h=i.getFullYear();if(e[1].length<2)e[1]="0"+e[1];}}else{if(e[1].length<2)e[1]="0"+e[1];h=parseInt(e[2],10);}if(h<1000)if(h<30||h>99)h+=2000;else h+=1900;d=e[0]+"/"+e[1]+"/"+h.toString();}if(d!=a.value){a.value=d;if(a.onchange!=null)a.onchange();}}function DTB_DateKeys(a,b){var d,j,k,l,h;if(b==13){DTB_FormatDate(a);return true;}if(b==80){DTB_PopupCal(a.id);return false;}if(b!=33&&b!=34&&b!=38&&b!=40&&b!=84)return true;if(b!=84&&a.value!=""){DTB_FormatDate(a);j=new Date(a.value);if(isNaN(j))return;}else j=new Date();switch(b){case 33:j.setMonth(j.getMonth()+1);break;case 34:j.setMonth(j.getMonth()-1);break;case 38:j.setDate(j.getDate()+1);break;case 40:j.setDate(j.getDate()-1);break;default:break;}k=j.getDate();l=j.getMonth()+1;h=j.getFullYear();if(l<10)d="0"+l.toString()+"/";else d=l.toString()+"/";if(k<10)d=d+"0"+k.toString()+"/"+h.toString();else d=d+k.toString()+"/"+h.toString();a.value=d;a.select();if(a.onchange!=null)a.onchange();return false;}function DTB_PopupCal(c){var a,j,m;a=document.getElementById(c);if(a.disabled)return;m=window.showModalDialog('<%=WebResource("EWSoftware.Web.Controls.HTML.Calendar.html")%>',a.value,"dialogHeight: 200px; dialogWidth: 260px; "+"center: yes; help: no; resizable: yes; status: no;");if(m!=null)a.value=m;a.focus();a.select();}