//=============================================================================
// File    : CCValidator.js
// Author  : Eric Woodruff  (Eric@EWoodruff.us)
// Updated : 04/09/2003
var CCV_lCurrType;
function CCV_ValidatorEvaluateIsValid(a){var c=parseInt(a.cardtypes,10);var b=ValidatorGetValue(a.controltovalidate);var e,f,g;b=ValidatorTrim(b);if(b.length==0)return true;CCV_lCurrType=0;e=CCV_ValidateCardNumber(b,c);if(e&&typeof(a.cardtypectl)=="string"){f=a.cardtypectl;if(e&&f!=""){g=ValidatorGetValue(f);if(parseInt(g,10)!=CCV_lCurrType)e=false;}}return e;}function CCV_ValidateCardNumber(b,c){if((c&0x00000001)!=0&&/^(4\d{12})|(4\d{15})$/.test(b)){CCV_lCurrType=0x00000001;return CCV_TestChecksum(b);}if((c&0x00000002)!=0&&/^5[1-5]\d{14}$/.test(b)){CCV_lCurrType=0x00000002;return CCV_TestChecksum(b);}if((c&0x00000004)!=0&&/^3[47]\d{13}$/.test(b)){CCV_lCurrType=0x00000004;return CCV_TestChecksum(b);}if((c&0x00000008)!=0&&/^6011\d{12}$/.test(b)){CCV_lCurrType=0x00000008;return CCV_TestChecksum(b);}if((c&0x00000010)!=0&&/^(30[0-5]\d{11})|(3[68]\d{12})$/.test(b)){CCV_lCurrType=0x00000010;return CCV_TestChecksum(b);}if((c&0x00000020)!=0&&/^(2014|2149)\d{11}/.test(b)){CCV_lCurrType=0x00000020;return CCV_TestChecksum(b);}if((c&0x00000040)!=0&&/^(3\d{15})|((2131|1800)\d{11})$/.test(b)){CCV_lCurrType=0x00000040;return CCV_TestChecksum(b);}if((c&0x01000000)!=0){CCV_lCurrType=0x01000000;return CCV_TestChecksum(b);}return false;}function CCV_TestChecksum(b){var h,i,j,k=0;for(h=b.length-1;h>=0;h--){k+=parseInt(b.charAt(h),10);h--;if(h>=0){j=String(parseInt(b.charAt(h),10)*2);for(i=0;i<j.length;i++)k+=parseInt(j.charAt(i),10);}}return(k%10==0);}